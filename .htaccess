# Security Headers
<IfModule mod_headers.c>
  # Content Security Policy - prevent XSS attacks
  Header set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' www.googletagmanager.com www.google-analytics.com mc.yandex.ru *.yandex.ru cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' fonts.googleapis.com; img-src 'self' data: https:; font-src 'self' fonts.gstatic.com; connect-src 'self' www.google-analytics.com mc.yandex.ru *.yandex.ru www.googletagmanager.com; frame-ancestors 'none'; base-uri 'self'; form-action 'self'"
  
  # HSTS - enforce HTTPS with preload
  Header set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
  
  # X-Frame-Options - prevent clickjacking
  Header set X-Frame-Options "DENY"
  
  # X-Content-Type-Options - prevent MIME sniffing
  Header set X-Content-Type-Options "nosniff"
  
  # X-XSS-Protection - enable browser XSS filter
  Header set X-XSS-Protection "1; mode=block"
  
  # Referrer-Policy - control referrer information
  Header set Referrer-Policy "strict-origin-when-cross-origin"
  
  # Permissions-Policy - control browser features
  Header set Permissions-Policy "geolocation=(), microphone=(), camera=(), payment=()"
</IfModule>

# Enable GZIP compression
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/plain
  AddOutputFilterByType DEFLATE text/html
  AddOutputFilterByType DEFLATE text/xml
  AddOutputFilterByType DEFLATE text/css
  AddOutputFilterByType DEFLATE text/javascript
  AddOutputFilterByType DEFLATE application/xml
  AddOutputFilterByType DEFLATE application/xhtml+xml
  AddOutputFilterByType DEFLATE application/rss+xml
  AddOutputFilterByType DEFLATE application/javascript
  AddOutputFilterByType DEFLATE application/x-javascript
  AddOutputFilterByType DEFLATE image/svg+xml
</IfModule>

# Add Cache-Control headers
<IfModule mod_headers.c>
  # Cache HTML for 1 hour
  <FilesMatch "\.html$">
    Header set Cache-Control "public, max-age=3600"
  </FilesMatch>
  
  # Cache CSS and JS for 1 year
  <FilesMatch "\.(css|js)$">
    Header set Cache-Control "public, max-age=31536000, immutable"
  </FilesMatch>
  
  # Cache images for 1 year
  <FilesMatch "\.(avif|webp|jxl|jpg|jpeg|png|gif|svg)$">
    Header set Cache-Control "public, max-age=31536000, immutable"
  </FilesMatch>
  
  # Cache JSON for 7 days
  <FilesMatch "\.json$">
    Header set Cache-Control "public, max-age=604800"
  </FilesMatch>
  
  # Cache XML for 24 hours
  <FilesMatch "\.xml$">
    Header set Cache-Control "public, max-age=86400"
  </FilesMatch>
</IfModule>
